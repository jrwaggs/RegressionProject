---
title: "Regression Project"
author: "JR Waggoner, Jose Baldomar, Andre Louie"
date: "April 10, 2019"
output: html_document
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(GGally)
```

``` {r importing the data,echo = FALSE}
# import the CSV
loandata <- read.csv("LoanStats3a.csv",stringsAsFactors = FALSE)
```

```{r subsetting the data,echo = FALSE}
# create a subset of data 
loan <- loandata %>%
 # filter(loan_status == "Charged Off") %>%
  mutate(tot_paid = total_rec_prncp + total_rec_int) %>%
  select(tot_paid,loan_amnt,term,int_rate,inq_last_6mths,
         annual_inc,purpose,installment,
         delinq_2yrs,revol_bal)
```

```{r factor term, echo = FALSE}
#factor loan_term; 2 levels (3,5 years)
loan$term <- factor(loan$term, labels = c("3year","5year"))
```

```{r factor purpose, echo = FALSE}
# there are 15 purpose categories, -> factor 
loan$purpose <- factor(loan$purpose)
```

### **Abstract**
Abstract text

### **Introduction**
Introduction text

### **Overview of the DataSet**
  The raw dataset is comprised of information describing all loans issued by LendingClub between 2007 and 2011. The data set can be found at  https://www.lendingclub.com/foliofn/rateDetail.action . A more narrlowly focused data set was then created by selecting the following features:

  - **loan_amnt** - The original principal loan amount.
  + **term** - Term length of the loan: 36 or 60 months.
  + **int_rate** - Interest rate of the loan.
  + **inq_last_6mths** - Number of inquiries on the borrowers credit report in the last 6 months
  + **annual_inc** - The borrowers annual income in USD.
  + **purpose** - General purpose for the loan: 1 of 15 categories.
  + **installment** - Amount of monthly loan payment.
  + **delinq_2yrs** - Number of delinquent accounts in the borrowers credit history in the last 2 years.
  + **revol_bal** - The borrowers revolving credit balance.
  
```{r exclude 1 record, echo = FALSE}
# randomly pull one record from the dataframe

#copy row @ index 291 to new DF
test_case <- loan[291,]
#delete row @ 291 from original DF
loan <- loan[-c(291),]
```
  
### **Exploratory analysis**
Exploratory text

##### **Distributions**

```{r  paid dist, echo=FALSE}
# distribution of Total paid
ggplot(loan, aes(pct_paid))+
  geom_histogram(bins = 30)+
  ggtitle("Distribution of Total Paid")+
  xlab("Total Paid")
```

```{r loan amt dist,echo=FALSE}
#distribution of loan amounts
ggplot(loan,aes(loan_amnt))+
  geom_histogram(bins = 7)+
  ggtitle("Distribution of Loan Amounts")+
  xlab("Loan amount")
```

```{r int rate dist,echo=FALSE}
# distribution of interest rates
ggplot(loan,aes(int_rate))+
  geom_histogram(bins=20)+
  ggtitle("Distribution of Loan Interest Rates")+
  xlab("Interest Rate")
```

```{r income dist,echo=FALSE}
#distribution of of annual incomes
ggplot(loan,aes(annual_inc))+
  geom_histogram(bins = 50)+
  ggtitle(("Distribution of Borrower Annual Income"))+
  xlab("Annual Income")
```

```{r loan purpose, echo = FALSE}
# Count of loan purpose
ggplot(loan,aes(purpose))+
  geom_bar()+
  ggtitle("Count of Loans by purpose")+
  xlab("Purpose")+
  coord_flip()
```

##### **Categorical Variables**

```{r repaid by purpose, echo = FALSE}
# boxplot of total repaid by purpose, with coordinates flipped
ggplot(loan, aes(purpose, tot_paid))+
  geom_boxplot()+
  coord_flip()+
  ggtitle("Total Paid by Purpose")+
  xlab("Purpose")+
  ylab("Total Paid")
```

```{r repaid by term, echo = FALSE}
# boxplot of loanterm  vs. total paid
ggplot(loan,aes(term,tot_paid)) +
  geom_boxplot()+
  ggtitle("Total Paid by Loan Term")+
  xlab("Loan Term")+
  ylab("Total Paid")

```

```{r loan amount by purpose, echo = FALSE}
# boxplot of loan amount by purpose
ggplot(loan,aes(purpose,loan_amnt))+
  geom_boxplot()+
  coord_flip()+
  ggtitle("Loan Amount by Purpose")+
  xlab("Purpose")+
  ylab("Loan Amount")
```

##### **Correlation Analysis**
```{r pairwise plot, echo = FALSE}
#subset of only numeric vaiables
numeric_loan <- loan %>%
   select(loan_amnt,int_rate,inq_last_6mths,annual_inc,installment,delinq_2yrs,tot_paid  )

#pairwise plots of numeric values  
ggpairs(numeric_loan)
```

### **Model Identification and Evaluation** 
Model Identification text


### **Model Application**
Model application text

```{r predict for holdout case,echo = FALSE}
#apply model to test case
predict(model,test_case)
```

https://www.statmethods.net/stats/regression.html

### **Assumptions and Limitations**
Assumption/Limitation text


